<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n l√Ω phim</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles.css">
  <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet" />
</head>

<body>
  <div class="bg-elements">
    <div class="bg-circle bg-circle-1"></div>
    <div class="bg-circle bg-circle-2"></div>
    <div class="bg-circle bg-circle-3"></div>
    <div class="bg-gradient-overlay"></div>
  </div>
  <div class="dashboard">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <div class="logo-container">
            <div class="logo-icon"><i class="fas fa-film"></i></div>
            <div class="logo-text">
              <h1>Cinema Movix</h1>
              <p>Qu·∫£n l√Ω phim</p>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="film-layout">
      <!-- Form nh·∫≠p phim -->
      <section class="film-form-card">
        <h2 class="card-title">Th√™m / S·ª≠a phim</h2>
        <form id="filmForm">
          <input type="hidden" id="phim_id" />
          <input type="text" id="ten_phim" placeholder="T√™n phim" required />
          <input type="text" id="dao_dien" placeholder="ƒê·∫°o di·ªÖn" required />
          <input type="text" id="ngon_ngu" placeholder="Ng√¥n ng·ªØ" required />
          <input type="number" id="do_tuoi" placeholder="ƒê·ªô tu·ªïi" required />
          <textarea
            id="mo_ta"
            placeholder="M√¥ t·∫£"
            rows="3"
            required></textarea>
          <input
            type="number"
            id="thoi_luong"
            placeholder="Th·ªùi l∆∞·ª£ng (ph√∫t)"
            required />
          <input
            type="text"
            id="poster_url"
            placeholder="Poster URL"
            required />
          <input type="file" id="poster_file" accept="image/*" />
          <img id="preview" class="preview-img" />
          <input
            type="text"
            id="trailer_url"
            placeholder="Trailer URL"
            required />
          <select id="the_loai" required>
            <option value="">-- Ch·ªçn th·ªÉ lo·∫°i --</option>
            <option>H√†nh ƒë·ªông</option>
            <option>Phi√™u l∆∞u</option>
            <option>H√†i</option>
            <option>T√¨nh c·∫£m / L√£ng m·∫°n</option>
            <option>T√¢m l√Ω</option>
            <option>Kinh d·ªã</option>
            <option>Gi·∫≠t g√¢n</option>
            <option>B√≠ ·∫©n</option>
            <option>Khoa h·ªçc vi·ªÖn t∆∞·ªüng</option>
            <option>Vi·ªÖn t∆∞·ªüng - Gi·∫£ t∆∞·ªüng</option>
            <option>H√¨nh s·ª±</option>
            <option>Chi·∫øn tranh</option>
            <option>Ch√≠nh k·ªãch</option>
            <option>T√†i li·ªáu</option>
            <option>Phim ti·ªÉu s·ª≠</option>
            <option>√Çm nh·∫°c</option>
            <option>Gia ƒë√¨nh</option>
            <option>Th·ªÉ thao</option>
            <option>Phim thi·∫øu nhi</option>
          </select>
          <button type="submit" class="btn-save">üíæ L∆∞u</button>
        </form>
      </section>

      <!-- Danh s√°ch phim -->
      <section class="film-list-card">
        <div class="film-list-header">
          <h2 class="card-title">Danh s√°ch phim</h2>
          <input
            type="text"
            id="searchInput"
            placeholder="üîç T√¨m ki·∫øm phim..." />
        </div>
        <div id="toast" class="film-toast">T·∫£i ·∫£nh th√†nh c√¥ng!</div>
        <div id="filmList"></div>
        <div id="pagination" class="pagination"></div>
      </section>
    </div>
  </div>
  <div class="film-layout">
    <!-- Form nh·∫≠p phim -->
    <div class="film-form-card">
      <form id="filmForm">
        <input type="hidden" id="phim_id">
        <input type="text" id="ten_phim" placeholder="T√™n phim" required>
        <input type="text" id="dao_dien" placeholder="ƒê·∫°o di·ªÖn" required>
        <input type="text" id="ngon_ngu" placeholder="Ng√¥n ng·ªØ" required>
        <input type="number" id="do_tuoi" placeholder="ƒê·ªô tu·ªïi" required>
        <input type="text" id="mo_ta" placeholder="M√¥ t·∫£" required>
        <input type="number" id="thoi_luong" placeholder="Th·ªùi l∆∞·ª£ng (ph√∫t)" required>
        <input type="text" id="poster_url" placeholder="Poster URL" required>
        <input type="file" id="poster_file" accept="image/*" />
        <img id="preview" width="200px" style="margin-bottom: 10px; border-radius: 8px;" />
        <input type="text" id="trailer_url" placeholder="Trailer URL" required>
        <select id="the_loai" required>
          <option value="">-- Ch·ªçn th·ªÉ lo·∫°i --</option>
          <option>H√†nh ƒë·ªông</option>
          <option>Phi√™u l∆∞u</option>
          <option>H√†i</option>
          <option>T√¨nh c·∫£m / L√£ng m·∫°n</option>
          <option>T√¢m l√Ω</option>
          <option>Kinh d·ªã</option>
          <option>Gi·∫≠t g√¢n</option>
          <option>B√≠ ·∫©n</option>
          <option>Khoa h·ªçc vi·ªÖn t∆∞·ªüng</option>
          <option>Vi·ªÖn t∆∞·ªüng - Gi·∫£ t∆∞·ªüng</option>
          <option>H√¨nh s·ª±</option>
          <option>Chi·∫øn tranh</option>
          <option>Ch√≠nh k·ªãch</option>
          <option>T√†i li·ªáu</option>
          <option>Phim ti·ªÉu s·ª≠</option>
          <option>√Çm nh·∫°c</option>
          <option>Gia ƒë√¨nh</option>
          <option>Th·ªÉ thao</option>
          <option>Phim thi·∫øu nhi</option>
        </select>
        <button type="submit" style="margin-top:12px;">L∆∞u</button>
      </form>
    </div>
    <!-- Danh s√°ch phim -->
    <div class="film-list-area">
      <div class="film-list-header">
        <h2>Danh s√°ch phim</h2>
        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm phim...">
      </div>
      <div id="toast" class="film-toast">T·∫£i ·∫£nh th√†nh c√¥ng!</div>
      <div id="filmList"></div>
    </div>
  </div>
  <!-- Script Upload ·∫£nh -->
  <script>
    // Hi·ªán toast
    const toast = document.getElementById('toast');
    toast.textContent = "T·∫£i ·∫£nh th√†nh c√¥ng!";
    toast.style.display = "block";
    setTimeout(() => { toast.style.display = "none"; }, 2000);
    const imageInput = document.getElementById('poster_file');
    const preview = document.getElementById('preview');
    const posterUrl = document.getElementById('poster_url');

    const IMGBB_API_KEY = 'd698d3c569cf045e45516a8fc568c999'; // Thay n·∫øu c·∫ßn

    imageInput.addEventListener('change', async () => {
      const file = imageInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onloadend = async () => {
        const base64Image = reader.result.split(',')[1];
        const formData = new FormData();
        formData.append('key', IMGBB_API_KEY);
        formData.append('image', base64Image);

        try {
          const res = await fetch('https://api.imgbb.com/1/upload', {
            method: 'POST',
            body: formData
          });
          const data = await res.json();
          if (data.success) {
            const link = data.data.display_url || data.data.url;
            posterUrl.value = link;
            preview.src = link;
          } else {
            alert("Upload th·∫•t b·∫°i.");
            console.log(data);
          }
        } catch (err) {
          alert("L·ªói m·∫°ng ho·∫∑c kh√¥ng th·ªÉ upload ·∫£nh.");
          console.error(err);
        }
      };
      reader.readAsDataURL(file);
    });
  </script>
  <!-- Script ch√≠nh x·ª≠ l√Ω CRUD -->
  <script src="script.js"></script>
</body>
</html>
